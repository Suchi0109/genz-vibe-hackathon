<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login / Register | GenZ Vibes</title>
<style>
  :root {
    --primary: #00e5ff;
    --dark-bg: #121212;
    --dark-container: #1f1f1f;
    --dark-input: #272727;
    --dark-text: #f0f0f0;
    --light-bg: #f9f9f9;
    --light-container: #ffffff;
    --light-input: #f0f0f0;
    --light-text: #111;
  }
  body { font-family:'Segoe UI', sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; transition:.3s; visibility:hidden; }
  body.dark { background:var(--dark-bg); color:var(--dark-text); }
  body.light { background:var(--light-bg); color:var(--light-text); }
  .theme-toggle{position:fixed;top:15px;right:15px;background:var(--primary);border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:bold;color:#121212;box-shadow:0 0 8px rgba(0,229,255,.5);}
  .container{padding:2rem;border-radius:12px;width:350px;max-width:90%;text-align:center;transition:.3s;}
  body.dark .container{background:var(--dark-container);box-shadow:0 0 30px rgba(0,229,255,.5);}
  body.light .container{background:var(--light-container);box-shadow:0 0 20px rgba(0,0,0,.1);}
  .logo{font-size:2.5rem;font-weight:bold;color:var(--primary);margin-bottom:1.5rem;animation:glow 1.5s infinite alternate;}
  @keyframes glow{from{text-shadow:0 0 5px var(--primary);}to{text-shadow:0 0 20px var(--primary);}}
  .toggle-btn{display:flex;justify-content:space-around;margin-bottom:1.5rem;cursor:pointer;}
  .toggle-btn button{background:none;border:none;font-weight:bold;padding:.5rem 1rem;transition:.3s;color:inherit;}
  .toggle-btn button.active{color:var(--primary);border-bottom:2px solid var(--primary);transform:scale(1.1);}
  form{display:none;flex-direction:column;gap:1rem;}
  form.active{display:flex;}
  input{padding:.6rem;border-radius:8px;border:none;transition:.3s;}
  body.dark input{background:var(--dark-input);color:var(--dark-text);}
  body.light input{background:var(--light-input);color:var(--light-text);}
  input:focus{outline:none;box-shadow:0 0 8px var(--primary);}
  .submit-btn{padding:.7rem;border:none;border-radius:8px;background:var(--primary);color:#121212;font-weight:bold;cursor:pointer;transition:.3s;}
  .submit-btn:hover:not(:disabled){background:#00c8e5;transform:scale(1.05);}
  .submit-btn:disabled{opacity:.6;cursor:not-allowed;}
  .error-box{margin-top:1rem;padding:.8rem;border-radius:8px;background:#ff4d4d;color:#fff;font-weight:bold;font-size:.9rem;display:none;animation:slideIn .4s ease;}
  .success-box{margin-top:1rem;padding:.8rem;border-radius:8px;background:#4caf50;color:#fff;font-weight:bold;font-size:.9rem;display:none;animation:slideIn .4s ease;}
  @keyframes slideIn{from{transform:translateY(-10px);opacity:0;}to{transform:translateY(0);opacity:1;}}
  .strength-meter{height:5px;background:#ccc;border-radius:3px;margin-top:.5rem;}
  .strength-meter.weak{background:#ff4d4d;width:33%;}
  .strength-meter.medium{background:#ffa500;width:66%;}
  .strength-meter.strong{background:#00ff00;width:100%;}
  p{font-size:.85rem;}
  span{color:var(--primary);cursor:pointer;}
</style>
</head>
<body>

<button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">üåô</button>

<div class="container">
  <div class="logo">‚ú® GenZ Vibes ‚ú®</div>
  <div class="toggle-btn">
    <button id="login-btn" class="active">Login</button>
    <button id="register-btn">Register</button>
  </div>

  <form id="login-form" class="active">
    <input type="email" id="login-email" placeholder="Email" required>
    <input type="password" id="login-password" placeholder="Password" required>
    <button type="submit" class="submit-btn">Login</button>
    <div class="error-box" id="login-error"></div>
    <p>Don't have an account? <span id="switch-to-register">Register</span></p>
  </form>

  <form id="register-form">
    <input type="text" id="reg-name" placeholder="Full Name" required>
    <input type="email" id="reg-email" placeholder="Email" required>
    <input type="password" id="reg-password" placeholder="Password" required>
    <div class="strength-meter" id="password-strength"></div>
    <input type="password" id="reg-confirm" placeholder="Confirm Password" required>
    <button type="submit" class="submit-btn">Register</button>
    <div class="error-box" id="register-error"></div>
    <div class="success-box" id="register-success"></div>
    <p>Already have an account? <span id="switch-to-login">Login</span></p>
  </form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";

// Firebase config
const firebaseConfig = {
  apiKey: process.env.FIREBASE_API_KEY,
  authDomain: "career-advisor-ai-470418.firebaseapp.com",
  projectId: "career-advisor-ai-470418",
  storageBucket: "career-advisor-ai-470418.firebasestorage.app",
  messagingSenderId: "768473952136",
  appId: "1:768473952136:web:10b2834534de3cdfed543d",
  measurementId: "G-3VT3TJ9886"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Auto redirect if already logged in
onAuthStateChanged(auth, user => {
  if(user) window.location.href="home.html";
  else document.body.style.visibility="visible";
});

// Theme toggle
const themeToggle = document.getElementById("theme-toggle");
const savedTheme = localStorage.getItem("theme") || "dark";
document.body.classList.add(savedTheme);
themeToggle.textContent = savedTheme==="dark"?"‚òÄ":"üåô";
themeToggle.addEventListener("click", ()=>{
  document.body.classList.toggle("dark");
  document.body.classList.toggle("light");
  const newTheme = document.body.classList.contains("dark")?"dark":"light";
  localStorage.setItem("theme",newTheme);
  themeToggle.textContent = newTheme==="dark"?"‚òÄ":"üåô";
});

// Form toggle
const loginBtn = document.getElementById("login-btn");
const registerBtn = document.getElementById("register-btn");
const loginForm = document.getElementById("login-form");
const registerForm = document.getElementById("register-form");
function showForm(form){
  loginForm.classList.toggle("active",form==="login");
  registerForm.classList.toggle("active",form==="register");
  loginBtn.classList.toggle("active",form==="login");
  registerBtn.classList.toggle("active",form==="register");
}
loginBtn.addEventListener("click",()=>showForm("login"));
registerBtn.addEventListener("click",()=>showForm("register"));
document.getElementById("switch-to-register").addEventListener("click",()=>showForm("register"));
document.getElementById("switch-to-login").addEventListener("click",()=>showForm("login"));

// Password strength
document.getElementById("reg-password").addEventListener("input",(e)=>{
  const strengthMeter=document.getElementById("password-strength");
  const pw=e.target.value;
  if(pw.length<8) strengthMeter.className="strength-meter weak";
  else if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])/.test(pw)) strengthMeter.className="strength-meter strong";
  else strengthMeter.className="strength-meter medium";
});

// Helper
function showMessage(id,msg,type="error"){
  const box=document.getElementById(id);
  box.innerText=msg;
  box.className=type==="success"?"success-box":"error-box";
  box.style.display="block";
  setTimeout(()=>{box.style.display="none";},5000);
}

// Register
registerForm.addEventListener("submit",async e=>{
  e.preventDefault();
  const name=document.getElementById("reg-name").value.trim();
  const email=document.getElementById("reg-email").value.trim().toLowerCase();
  const password=document.getElementById("reg-password").value;
  const confirm=document.getElementById("reg-confirm").value;
  if(password!==confirm){ showMessage("register-error","‚ö†Ô∏è Passwords don‚Äôt match!"); return; }
  try{
    const userCred = await createUserWithEmailAndPassword(auth,email,password);
    const uid=userCred.user.uid;
    await setDoc(doc(db,"users",uid),{ fullName:name, email, createdAt:new Date().toISOString() });
    showMessage("register-success","‚úÖ Registered! Log in now.", "success");
    showForm("login");
  }catch(err){
    let msg="üò¨ Something went wrong.";
    if(err.code==="auth/email-already-in-use") msg="üìß Email already registered!";
    if(err.code==="auth/weak-password") msg="üîë Weak password!";
    showMessage("register-error",msg);
  }
});

// Login
loginForm.addEventListener("submit",async e=>{
  e.preventDefault();
  const email=document.getElementById("login-email").value.trim().toLowerCase();
  const password=document.getElementById("login-password").value;
  try{
    const userCred = await signInWithEmailAndPassword(auth,email,password);
    window.location.href="home.html";
  }catch(err){
    let msg="‚ùå Login failed.";
    if(err.code==="auth/user-not-found") msg+=" No account found.";
    else if(err.code==="auth/wrong-password") msg+=" Wrong password.";
    showMessage("login-error",msg);
  }
});
</script>
</body>
</html>
